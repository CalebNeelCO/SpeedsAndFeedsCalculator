import json
from flask import Flask, jsonify, render_template, request
app = Flask(__name__)
  
materals = """{
  "Carbide": {
    "Aluminum 440, 356, 380, C61300": {
      "SFM": "500-1000",
      "IPM": {
        "1": 0.007,
        "0.125": 0.001,
        "0.1875": 0.002,
        "0.25": 0.002,
        "0.375": 0.003,
        "0.5": 0.004,
        "0.625": 0.005,
        "0.75": 0.006
      }
    }
  },
  "HSS (High speed steel)": {
    "Cast Iron": {
      "SFM": "80-100",
      "IPM": {
        "1": 0.006,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Mild Steel": {
      "SFM": "80-100",
      "IPM": {
        "1": 0.006,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Half Hard Brass": {
      "SFM": "80-100",
      "IPM": {
        "1": 0.006,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Half Hard Bronze": {
      "SFM": "80-100",
      "IPM": {
        "1": 0.006,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Brass": {
      "SFM": "100-200",
      "IPM": {
        "1": 0.01,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Bronze": {
      "SFM": "100-200",
      "IPM": {
        "1": 0.01,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Alloyed Aluminum": {
      "SFM": "100-200",
      "IPM": {
        "1": 0.01,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Abrasive Plastics": {
      "SFM": "100-200",
      "IPM": {
        "1": 0.01,
        "0.9375": 0.006,
        "0.875": 0.006,
        "0.8125": 0.006,
        "0.75": 0.006,
        "0.6875": 0.004,
        "0.625": 0.004,
        "0.5625": 0.004,
        "0.5": 0.003,
        "0.4375": 0.003,
        "0.375": 0.003,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Aluminum CP": {
      "SFM": "600-900",
      "IPM": {
        "1": 0.01,
        "0.9375": 0.006,
        "0.875": 0.004,
        "0.8125": 0.004,
        "0.75": 0.004,
        "0.6875": 0.003,
        "0.625": 0.003,
        "0.5625": 0.003,
        "0.5": 0.002,
        "0.4375": 0.002,
        "0.375": 0.002,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    },
    "Plastics": {
      "SFM": "600-900",
      "IPM": {
        "1": 0.01,
        "0.9375": 0.006,
        "0.875": 0.004,
        "0.8125": 0.004,
        "0.75": 0.004,
        "0.6875": 0.003,
        "0.625": 0.003,
        "0.5625": 0.003,
        "0.5": 0.002,
        "0.4375": 0.002,
        "0.375": 0.002,
        "0.3125": 0.002,
        "0.25": 0.002,
        "0.1875": 0.001,
        "0.125": 0.001,
        "0.09375": 0.0005,
        "0.0625": 0.0005
      }
    }
  }
}"""
materals = json.loads(materals)


def getSFM(materal, endmilltype):
  sfm = materals[endmilltype][materal]["SFM"]
  sfm = sfm.split("-")
  return sfm

def getRMP(dia, sfm):
  RPM = (3.82*int(sfm))/dia
  return RPM
  
def getCL(dia,  materal, endmilltype):
  if(materals[endmilltype][materal]["IPM"][str(dia)] != None):
    return materals[endmilltype][materal]["IPM"][str(dia)]
  else:
    return False
  
def getSpeeds(dia, numOfTeeth, materal="", endmilltype="", sfm=0, CL = 0):
  speeds = []
  if(sfm != 0):
    sfm = [sfm]
  else:
    sfm = getSFM(materal, endmilltype)
  for x in range(len(sfm)):
    rpm = getRMP(dia, sfm[x])
    if(CL == 0):
      CL = getCL(dia, materal, endmilltype)
    ipr = CL * numOfTeeth
    ipm = ipr * rpm
    speeds.append({'num':x,'RPM':rpm, 'SFM':sfm[x] ,'IPR': ipr, 'IPM':ipm, "ChipLoad": CL})
  return speeds
  

#print getSpeeds(0.5,4,materal="Aluminum 440, 356, 380, C61300",endmilltype="Carbide")

@app.route('/')
def hello_world():
    return render_template('index.html', materals=materals)

@app.route('/speedsandfeedsendpoint')
def calulatue():
    a = request.args.get('a', 0, type=int)
    b = request.args.get('b', 0, type=int)
    return jsonify(result=a + b)
""" "":{
      SFM:"",
      "1/8":,
      "3/16":,
      "1/4":,
      "3/8":,
      "1/2":,
      "5/8":,
      "3/4":,
      "1":,
    }"""

if __name__ == '__main__':
    app.run(debug=True, use_reloader=True)
